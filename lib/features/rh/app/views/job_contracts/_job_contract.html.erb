<% form_for(@job_contract, :url => employee_job_contract_path([@employee,@job_contract]), :html => {:multipart => true}) do |form| %>
  <%= form.error_messages %>

  <% if is_form_view?%>
    <h2>Informations de l&apos;employé</h2>
    <p>
      <label>Civilité :</label>
      <strong><%= @employee.civility.name %></strong>
    </p>
    <p>
      <label>Nom :</label>
      <strong><%= @employee.last_name %></strong>
    </p>
    <p>
      <label>Prénom :</label>
      <strong><%= @employee.first_name %></strong>
    </p>
  <% end %>

  <h2>Informations du contrat de travail</h2>
  
  <p>
    <%= form.label :job_contract_type_id%>
    <%= form.form_or_view(job_contract_type_select(@job_contract),:job_contract_type, :name) %>
  </p>
  <p>
    <%= form.label :start_date%>
    <%= form.form_or_view(form.date_select( :start_date, :start_year => 1950, :order => [:day,:month,:year], :disabled => is_gone?(@job_contract)),:start_date) %>
  </p>
  <p>
    <%= form.label :end_date%>
    <%= form.form_or_view(form.date_select( :end_date, :start_year => 1950, :order => [:day,:month,:year], :disabled => (@job_contract.end_date.nil? or is_gone?(@job_contract) or @job_contract.job_contract_type.limited==false)), :end_date) %> 
  </p>
  <p>
    <%= form.label :employee_state_id%>
    <%= form.form_or_view(form.collection_select( :employee_state_id, EmployeeState.find(:all,:conditions => ["active=?",1]), :id, :name,{} , {:disabled => is_gone?(@job_contract)}), :employee_state, :name)%>
  </p>

  <% fields_for 'job_contract[salary_attributes]',@job_contract.salaries.first do |salary_form| %>
    <%= salary_form.error_messages %>
    <p>
      <%= salary_form.label  :gross_amount%>
      <%= salary_form.form_or_view(salary_form.text_field( :gross_amount, { :size => 8, :maxlength => 10, :class => "disable-stylesheet-width",:disabled => is_gone?(@job_contract) } ),' ' )%>
      <% if !is_form_view? %>
      <%= strong(display_formatted_salary(@job_contract.actual_salary))+" "+link_to( 'Voir historique des salaires', employee_salaries_path(@employee))%>
      <%= display_job_contract_edit_link(@job_contract_controller, @employee)%>
      <% end %>
    </p>
  <% end %>


  


 

  <% if is_gone?(@job_contract)%>
    <div id="employee_departure_form" >
  <% else %>
    <div id="employee_departure_form" style="display:none;">
  <% end %>

    <h2>D&eacute;part de l&apos;employ&eacute;e</h2>
    <p>
      <%= form.label :employee_state_id, "Status :"%>
      <%= employee_state_inactive(@job_contract)%>
    </p>
    <p>
      <%= label :departure, "Date de d&eacute;part"%>
      <%= form.date_select :departure,{ :start_year => 1950, :order => [:day,:month,:year], :disabled => !is_gone?(@job_contract)}%>
    </p>

  </div>

  <!-- Display Documents div -->
  <%= display_documents_and_add_documents_button(@job_contract, @documents, params, @new_document_number, @error) %>
  
  <% if is_form_view? %>
    <p><%= form.submit "Modifier" %></p>
  <% end%>

<% end %>
