<%
require_locals supply_class, supplies

stock_flow_class = stock_flow.class.name.underscore
%>

<div class="presentation_medium">
  <% unless supplies.empty? %>
    <% form_for(stock_flow) do |form| %>
      <%= form.error_messages %>
      <%= hidden_field_tag :supply_class, supply_class %>
      
      <p>
        <%= form.label :supply_id, nil, :required => :required %>
        <%= form.collection_select(:supply_id, supplies, :id, :designation, :include_blank => "Veuillez choisir l'article concernÃ©") %>
        <%= observe_field("#{stock_flow_class}_supply_id", :url => update_supply_stock_infos_path, :with => "supply_id") if stock_flow.is_a?(StockInput) %>
      </p>
      <p>
        <%= form.label :identifier, nil, :required => :required %>
        <%= form.text_field :identifier %>
      </p>
      <p>
        <%= form.label :quantity, nil, :required => :required %>
        <%= form.text_field :quantity, :size => 5 %>
      </p>
       
      <% if stock_flow.is_a?(StockInput) %>
        <p>
          <%= form.label :unit_price, nil, :required => :required %>
          <%= form.text_field(:unit_price, :value => number_with_precision(stock_flow.unit_price, :precision => 2), :size => 10) + " &euro;" %>
        </p>
      <% end %>
      
      <%= form.form_buttons(:except => [:submit_and_continue], :return_uri_on_new => send("new_#{stock_flow_class}_path", :supply_class => supply_class)) %>
    <% end %>
  <% else %>
    <p>Aucun article disponible pour effectuer un mouvement de stock</p>
  <% end %>
</div>
